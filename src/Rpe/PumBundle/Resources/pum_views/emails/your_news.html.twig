{% extends "pum://empty_layout.html.twig" %}

{% block main_content %}
{% spaceless %}
{% set actor = pum_entity(notification.actorType, notification.actorId) %}
{% set target = pum_entity(notification.targetType, notification.targetId) %}

{% if app.request is not null and app.request.schemeAndHttpHost %}
    {% set base_url = app.request.schemeAndHttpHost %}
{% else %}
    {% set base_url = schemeAndHttpHost %}
{% endif %}
<div class="wrapper" style="width:530px; margin:0 auto; font-family: arial, sans-serif;">
    <!-- ========= -->
    <!-- SMALL TOP -->
    <!-- ========= -->
    <table border="0" cellpadding="0" cellspacing="0">
        <tr height="50" style="height:50px;">
            <td width="530" style="background-color:#fff; color:#000; height: 50px; width:530px; text-align:center; font-size:11px;">
                Si cet email ne s'affiche pas correctement, <a href="{{ base_url }}{{ path('mail_notification_yournews', {'notifId': notification.id, 'contactId': contact.id}) }}" style="color:#259aae; text-decoration:none;">accédez à sa version en ligne.</a>
            </td>
        </tr>
    </table>
    <!-- ====== -->
    <!-- HEADER -->
    <!-- ====== -->
    <table border="0" cellpadding="0" cellspacing="0">
        <tr height="80" style="height:80px; background-color:#1d2129;">
            <td width="530" style="width:530px;">
                <table border="0" cellpadding="0" cellspacing="0">
                    <tr height="24" style="height:24px;">
                        <td width="530" style="width:530px;"></td>
                    </tr>
                    <tr height="32" style="height:32px;">
                        <td width="530" style="width:530px;">
                            <table border="0" cellpadding="0" cellspacing="0">
                                <tr height="32" style="height:32px;">
                                    <td width="20" style="width:20px">
                                        <!-- padding -->
                                    </td>
                                    <td width="154" style="width:154px;">
                                        <!-- LOGO -->
                                        <a href="{{ base_url }}{{ path('home') }}">
                                            <img src="{{ base_url }}{{ asset('bundles/rpepum/images/email/01-logo.jpg') }}" style="display:block; border:none;" />
                                        </a>
                                    </td>
                                    <td width="234" style="width:234px">
                                        <!-- whitespace -->
                                    </td>
                                    <td width="70" style="width:70px; text-align: left;">
                                        <!-- LINK -->
                                        <a href="{{ base_url }}{{ path('profil', {'id': hashEncode(contact.id)}) }}" style="color:#259aae; text-decoration:none; font-size:12px;">
                                            Mon profil
                                        </a>
                                    </td>
                                    <td width="32" style="width:32px">
                                        <!-- PROFIL PIC -->
                                        <a href="{{ base_url }}{{ path('profil', {'id': hashEncode(contact.id)}) }}">
                                            {{ macros.show_user_avatar(contact, 'relation', 32, null) }}
                                        </a>
                                    </td>
                                    <td width="20" style="width:20px">
                                        <!-- padding -->
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr height="24" style="height:24px;">
                        <td width="530" style="width:530px;"></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    <!-- ===== -->
    <!-- TITLE -->
    <!-- ===== -->
    <table border="0" cellpadding="0" cellspacing="0">
        <tr height="80" style="height:80px;">
            <td width="530" style="width:530px; background-color:#374860;">
                <table border="0" cellpadding="0" cellspacing="0">
                    <tr height="20" style="height:20px;">
                        <td width="530" style="width:530px;"></td>
                    </tr>
                    <tr height="40" style="height:40px;">
                        <td width="530" style="width:530px;font-family:Verdana, sans-serif;font-size:18px;color:#ffffff;padding-left:25px;">
                            Votre actualité sur Viaeduc
                        </td>
                    </tr>
                    <tr height="20" style="height:20px;">
                        <td width="530" style="width:530px;"></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    <!-- ======= -->
    <!-- CONTENT -->
    <!-- ======= -->
    <table border="0" cellpadding="0" cellspacing="0">
       <tr>
           <td width="530" style="width:530px; background-color:#374860;">
               <table border="0" cellpadding="0" cellspacing="0">
                    <tr>
                        <td width="2" style="width:2px;"></td>
                        <td width="526" style="width:526px;">
                            <!-- content -->
                            <table border="0" cellpadding="0" cellspacing="0">
                                <tr height="10" style="height:10px;">
                                    <td width="10" style="width:10px; background-color:#fff;"></td>
                                    <td width="506" style="width:506px; background-color:#fff;"></td>
                                    <td width="10" style="width:10px; background-color:#fff;"></td>
                                </tr>
                                <tr>
                                    <td width="10" style="width:10px; background-color:#fff;"></td>
                                    <td width="506" style="width:506px; background-color:#fff;">
                                        <table border="0" cellpadding="0" cellspacing="0">
                                            <tr height="20" style="height:20px;">
                                                <td width="20" style="width:20px; background-color:#ededed"></td>
                                                <td width="466" style="width:466px; background-color:#ededed"></td>
                                                <td width="20" style="width:20px; background-color:#ededed"></td>
                                            </tr>
                                            <tr>
                                                <td width="20" style="width:20px; background-color:#ededed"></td>
                                                <td width="466" style="width:466px; background-color:#ededed">
                                                    <table border="0" cellpadding="0" cellspacing="0">
                                                        <tr>
                                                            <td width="64" style="width:64px; vertical-align:top;">
                                                                <!-- img -->
                                                                <a href="{{ base_url }}{{ path('profil', {'id': hashEncode(actor.id)}) }}" style="display:block; float:left; height:64px; width:64px;">
                                                                    <img src="{{ base_url }}{{ asset('bundles/rpepum/images/email/05-group-tmp-2.jpg') }}" style="display:block; border:none;">
                                                                </a>
                                                            </td>
                                                            <td width="6" style="width:6px;"></td>
                                                            <td width="300" style="width:300px; vertical-align:top; font-family:Verdana,sans-serif; font-size:10px;">
                                                                <!-- txt -->
                                                                <span style="display:block; float:left; clear:both; color:#a1a1a1;">
                                                                    <a href="{{ base_url }}{{ path('profil', {'id': hashEncode(actor.id)}) }}" style="font-weight:bold; color:#37485f; text-decoration:none;">{{ actor.firstname }} {{ actor.lastname }}</a>

                                                                    <a href="{{ base_url }}{{ path('menu_notification_view', {'id': notification.id}) }}" style="text-decoration:none;color:#37485f;">
                                                                        {% if notification.isTypePublication %}
                                                                            a publié un message

                                                                            {% if target.isTypeWall %}
                                                                                sur <strong>votre profil</strong>
                                                                            {% elseif target.isTypeGroup %}
                                                                                dans le groupe <strong>{{ target.publishedGroup.name }}</strong>
                                                                            {% endif %}
                                                                        {% elseif notification.isTypeResource %}
                                                                            a publié une ressource
                                                                            {% if target.isTypeWall %}
                                                                                sur <strong>votre profil</strong>
                                                                            {% elseif target.isTypeGroup %}
                                                                                dans le groupe <strong>{{ target.publishedGroup.name }}</strong>
                                                                            {% endif %}
                                                                        {% elseif notification.isTypeResourceEdit %}
                                                                            a édité la ressource
                                                                            {% if target.isTypeWall %}
                                                                                sur <strong>votre profil</strong>
                                                                            {% elseif target.isTypeGroup %}
                                                                                dans le groupe <strong>{{ target.publishedGroup.name }}</strong>
                                                                            {% endif %}
                                                                        {% elseif notification.isTypeRecommend %}
                                                                            a recommandé

                                                                            {% if notification.targetType == 'post' %}
                                                                                {% if target.author == user %}
                                                                                    votre
                                                                                {% else %}
                                                                                    une
                                                                                {% endif %}

                                                                                {% if target.resource %}
                                                                                    ressource
                                                                                {% else %}
                                                                                    publication
                                                                                {% endif %}

                                                                                {% if target.isTypeWall %}
                                                                                    sur <strong>votre profil</strong>
                                                                                {% elseif target.isTypeGroup %}
                                                                                    dans le groupe <strong>{{ target.publishedGroup.name }}</strong>
                                                                                {% endif %}
                                                                            {% elseif notification.targetType == 'comment' %}
                                                                                {% if target.user == user %}
                                                                                    votre
                                                                                {% else %}
                                                                                    un
                                                                                {% endif %}

                                                                                commentaire

                                                                                {% if target.post.isTypeWall %}
                                                                                    sur <strong>votre profil</strong>
                                                                                {% elseif target.post.isTypeGroup %}
                                                                                    dans le groupe <strong>{{ target.post.publishedGroup.name }}</strong>
                                                                                {% endif %}
                                                                            {% endif %}
                                                                        {% elseif notification.isTypeComment %}
                                                                            a commenté

                                                                            {% if target.post.author == user %}
                                                                                votre
                                                                            {% else %}
                                                                                une
                                                                            {% endif %}

                                                                            {% if target.post.resource %}
                                                                                ressource
                                                                            {% else %}
                                                                                publication
                                                                            {% endif %}

                                                                            {% if target.post.isTypeWall %}
                                                                                {% if target.post.targetUser == user %}
                                                                                    sur <strong>votre profil</strong>
                                                                                {% elseif target.post.targetUser == actor and target.post.isLike(user) %}
                                                                                    que vous avez recommandé sur <strong>son profil</strong>
                                                                                {% elseif target.post.isLike(user) %}
                                                                                    que vous avez recommandé sur le profil de <strong>{{ target.post.targetUser.firstname }} {{ target.post.targetUser.lastname }}</strong>
                                                                                {% endif %}
                                                                            {% elseif target.post.isTypeGroup %}
                                                                                {% if contact.isGroupOwner(target.post.publishedGroup) %}
                                                                                    sur votre groupe <strong>{{ target.post.publishedGroup.name }}</strong>
                                                                                {% elseif actor.isGroupOwner(target.post.publishedGroup) and target.post.isLike(user) %}
                                                                                    que vous avez recommandé sur son groupe <strong>{{ target.post.publishedGroup.name }}</strong>
                                                                                {% elseif target.post.isLike(user) %}
                                                                                    que vous avez recommandé sur le groupe <strong>{{ target.post.publishedGroup.name }}</strong>
                                                                                {% endif %}
                                                                            {% endif %}
                                                                        {% elseif notification.isTypeRelationAccept %}
                                                                            a accepté votre demande de mise en relation
                                                                        {% elseif notification.isTypeJoinUserAccept %}
                                                                            a rejoint le groupe <strong>{{ target.name }}</strong> suite à votre invitation
                                                                        {% elseif notification.isTypeJoinGroupAccept %}
                                                                            vous a ajouté au groupe <strong>{{ target.name }}</strong> suite à votre demande
                                                                        {% elseif notification.isTypeSharePublication %}
                                                                            a partagé votre publication <strong>{{ target.name }}</strong>
                                                                        {% elseif notification.isTypeShareResource %}
                                                                            a partagé votre ressource <strong>{{ target.name }}</strong>
                                                                        {% elseif notification.isTypeAnswer %}
                                                                            a répondu à votre question <strong>{{ target.name }}</strong>
                                                                        {% elseif notification.isTypeBecomeAdmin %}
                                                                        	vous a nommé animateur du groupe <strong>{{ target.name }}</strong>
                                                                        {% endif %}
                                                                    </a>
                                                                </span>
                                                                <a href="{{ base_url }}{{ path('menu_notification_view', {'id': notification.id}) }}" style="display:block; float:left; clear:both; font-size:12px; color:#37485f; text-decoration:none; margin-top:10px;">
                                                                    {% if notification.isTypePublication %}
                                                                        {{ target.content|raw|nl2br }}
                                                                    {% elseif notification.isTypeResource %}
                                                                        {{ target.name }}
                                                                    {% elseif notification.isTypeRecommend %}
                                                                        {% if notification.targetType == 'post' %}
                                                                            {{ target.name|raw|upper }}
                                                                        {% elseif notification.targetType == 'comment' %}
                                                                            {{ target.content|raw|nl2br }}
                                                                        {% endif %}
                                                                    {% elseif notification.isTypeComment %}
                                                                        {% if target.post.isTypeWall %}
                                                                            {{ target.content|raw|nl2br }}
                                                                        {% elseif target.post.isTypeGroup %}
                                                                            {{ target.content|raw|nl2br }}
                                                                        {% endif %}
                                                                    {% endif %}
                                                                </a>
                                                            </td>
                                                            <td width="6" style="width:6px;"></td>
                                                            <td width="90" style="width:90px;">
                                                                <!-- btn -->
                                                                <a href="{{ base_url }}{{ path('menu_notification_view', {'id': notification.id}) }}" style="display:block; height:30px; width:86px;">
                                                                    <img src="{{ base_url }}{{ asset('bundles/rpepum/images/email/05-btn-consulter.jpg') }}" style="display:block; border:none;">
                                                                </a>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </td>
                                                <td width="20" style="width:20px; background-color:#ededed"></td>
                                            </tr>
                                            <tr height="20" style="height:20px;">
                                                <td width="20" style="width:20px; background-color:#ededed"></td>
                                                <td width="466" style="width:466px; background-color:#ededed"></td>
                                                <td width="20" style="width:20px; background-color:#ededed"></td>
                                            </tr>
                                        </table>
                                    </td>
                                    <td width="10" style="width:10px; background-color:#fff;"></td>
                                </tr>
                                <tr height="10" style="height:10px;">
                                    <td width="10" style="width:10px; background-color:#fff;"></td>
                                    <td width="506" style="width:506px; background-color:#fff;"></td>
                                    <td width="10" style="width:10px; background-color:#fff;"></td>
                                </tr>
                            </table>
                        </td>
                        <td width="2" style="width:2px;"></td>
                    </tr>
                    <tr height="2" style="height:2px;">
                        <td width="2" style="width:2px;"></td>
                        <td width="526" style="width:526px;"></td>
                        <td width="2" style="width:2px;"></td>
                    </tr>
               </table>
           </td>
       </tr>
    </table>
    <!-- ====== -->
    <!-- FOOTER -->
    <!-- ====== -->
    {# <table border="0" cellpadding="0" cellspacing="0">
        <tr height="157" style="height:157px;">
            <td width="530" style="width:530px;">
                <a href="#"><img src="{{ base_url }}{{ asset('bundles/rpepum/images/email/03-picture-your-group.jpg') }}" style="display:block; border:none"></a>
            </td>
        </tr>
        <tr height="30" style="height:30px; background-color:#242a33;">
            <td width="530" style="width:530px;">
                <table border="0" cellpadding="0" cellspacing="0">
                    <tr height="30" style="height:30px;">
                        <td width="265" style="width:265px; font-family:Verdana,sans-serif; font-size:12px; text-align:right; color:#fff">
                            <span style="font-weight:bold">Connectez-vous</span> avec les autres :
                        </td>
                        <td width="265" style="width:265px;">
                            <a href="#" style="background-color:#d77033; color:#fff; text-transform:uppercase; text-decoration:none; font-size:14px; padding:5px 10px; margin-left:5px;">Trouver plus de groupes</a>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr height="30" style="height:30px; background-color:#242a33;">
            <td width="530" style="width:530px;">
            </td>
        </tr>
    </table> #}
    <table border="0" cellpadding="0" cellspacing="0">
        <tr heigh="50 "style="height:50px;">
            <td width="530" style="width:530px; background-color:#1c2027;"></td>
        </tr>
    </table>
    <!-- ===== -->
    <!-- LEGAL -->
    <!-- ===== -->
    <table border="0" cellpadding="0" cellspacing="0">
        <tr height="100" style="height:100px;">
            <td width="530" style="width:530px; font-family:arial, sans-serif; font-size:11px; color:#000; text-align:center;">
                <a href="{{ base_url ~ path('login') ~ '#popin_forget_password'}}" style="color:#259aae; text-decoration:none; font-weight:bold;">Vous avez oublié votre mot de passe ?</a><br />
                Pour gérer les e-mails que nous vous envoyons, rendez-vous dans les <a href="{{ base_url ~ path('my_notifications') }}" style="color:#000000; text-decoration:none;">paramètres de votre compte</a>.<br>
                {# Conformément à la loi "Informatique et Libertés" du 6 janvier 1978 modifiée en 2004, vous bénéficiez d'un droit
                d'accès et de rectification aux informations qui vous concernent, que vous pouvez exercer en nous
                adressant votre demande à <a href="#" style="color:#000000; text-decoration:none;">newsletter@blocmarque.fr</a>. #}
            </td>
        </tr>
    </table>
</div>
{% endspaceless %}
{% endblock %}